(()=>{"use strict";const t=skyrimPlatform;var e,r,a,i,o,c,n,h,f,s={'"':'\\"',"'":"\\'","\\":"\\\\","<":"\\<",">":"\\>"},g=/[&<>"'\\\/]/;!function(t){t[t.Fist=0]="Fist",t[t.Sword=1]="Sword",t[t.Dagger=2]="Dagger",t[t.WarAxe=3]="WarAxe",t[t.Mace=4]="Mace",t[t.Greatsword=5]="Greatsword",t[t.Battleaxe=6]="Battleaxe",t[t.Warhammer=6]="Warhammer",t[t.Bow=7]="Bow",t[t.Staff=8]="Staff",t[t.Crossbow=9]="Crossbow"}(e||(e={})),function(t){t.Fist="hitFistPlayer",t.Sword="hitSwordPlayer",t.Dagger="hitDaggerPlayer",t.WarAxe="hitWarAxePlayer",t.Mace="hitMacePlayer",t.Greatsword="hitGreatswordPlayer",t.Battleaxe="hitBattleAxeWarhammerPlayer",t.Warhammer="hitBattleAxeWarhammerPlayer",t.Bow="hitBowPlayer",t.Staff="hitStaffPlayer",t.Crossbow="hitCrossbowPlayer"}(r||(r={})),function(t){t.Fist="hitPowerAttackFistPlayer",t.Sword="hitPowerAttackSwordPlayer",t.Dagger="hitPowerAttackDaggerPlayer",t.WarAxe="hitPowerAttackWarAxePlayer",t.Mace="hitPowerAttackMacePlayer",t.Greatsword="hitPowerAttackGreatswordPlayer",t.Battleaxe="hitPowerAttackBattleAxeWarhammerPlayer",t.Warhammer="hitPowerAttackBattleAxeWarhammerPlayer",t.Staff="hitPowerAttackStaffPlayer"}(a||(a={})),function(t){t.Fist="hitFistNpc",t.Sword="hitSwordNpc",t.Dagger="hitDaggerNpc",t.WarAxe="hitWarAxeNpc",t.Mace="hitMaceNpc",t.Greatsword="hitGreatswordNpc",t.Battleaxe="hitBattleAxeWarhammerNpc",t.Warhammer="hitBattleAxeWarhammerNpc",t.Bow="hitBowNpc",t.Staff="hitStaffNpc",t.Crossbow="hitCrossbowNpc"}(i||(i={})),function(t){t.Fist="hitPowerAttackFistNpc",t.Sword="hitPowerAttackSwordNpc",t.Dagger="hitPowerAttackDaggerNpc",t.WarAxe="hitPowerAttackWarAxeNpc",t.Mace="hitPowerAttackMaceNpc",t.Greatsword="hitPowerAttackGreatswordNpc",t.Battleaxe="hitPowerAttackBattleAxeWarhammerNpc",t.Warhammer="hitPowerAttackBattleAxeWarhammerNpc",t.Staff="hitPowerAttackStaffNpc"}(o||(o={})),function(t){t.Fist="hitFistNpcDW",t.Sword="hitSwordNpcDW",t.Dagger="hitDaggerNpcDW",t.WarAxe="hitWarAxeNpcDW",t.Mace="hitMaceNpcDW"}(c||(c={})),function(t){t.Fist="hitFistPlayerDW",t.Sword="hitSwordPlayerDW",t.Dagger="hitDaggerPlayerDW",t.WarAxe="hitWarAxePlayerDW",t.Mace="hitMacePlayerDW"}(n||(n={})),function(t){t.Fist="hitPowerAttackFistPlayerDW",t.Sword="hitPowerAttackSwordPlayerDW",t.Dagger="hitPowerAttackDaggerPlayerDW",t.WarAxe="hitPowerAttackWarAxePlayerDW",t.Mace="hitPowerAttackMacePlayerDW"}(h||(h={})),function(t){t.Fist="hitPowerAttackFistNpcDW",t.Sword="hitPowerAttackSwordNpcDW",t.Dagger="hitPowerAttackDaggerNpcDW",t.WarAxe="hitPowerAttackWarAxeNpcDW",t.Mace="hitPowerAttackMaceNpcDW"}(f||(f={}));var p,l,A,w,F,P,k,m,W,D,S,u,y={powAtk:{npc:Object.create(o),player:Object.create(a)},regAtk:{npc:Object.create(i),player:Object.create(r)}},d={powAtk:{npc:Object.create(f),player:Object.create(h)},regAtk:{npc:Object.create(c),player:Object.create(n)}};function x(e){var r=t.Game.getFormEx(e);return t.Actor.from(r)}function N(e,r){t.Debug.sendAnimationEvent(e,r)}!function(t){t.Fire="hitFireEffectNovice",t.Frost="hitFrostEffectNovice",t.Shock="hitShockEffectNovice"}(p||(p={})),function(t){t.Fire="hitFireEffectApprentice",t.Frost="hitFrostEffectApprentice",t.Shock="hitShockEffectApprentice"}(l||(l={})),function(t){t.Fire="hitFireEffectAdept",t.Frost="hitFrostEffectAdept",t.Shock="hitShockEffectAdept"}(A||(A={})),function(t){t.Fire="hitFireEffectExpert",t.Frost="hitFrostEffectExpert",t.Shock="hitShockEffectExpert"}(w||(w={})),function(t){t.Fire="hitFireEffectMaster",t.Frost="hitFrostEffectMaster",t.Shock="hitShockEffectMaster"}(F||(F={})),function(t){t.Fire="hitFireEffectConcentration",t.Frost="hitFrostEffectConcentration",t.Shock="hitShockEffectConcentration"}(P||(P={})),function(t){t.Fire="hitFireEffectConcentrationEnd",t.Frost="hitFrostEffectConcentrationEnd",t.Shock="hitShockEffectConcentrationEnd"}(k||(k={})),function(t){t.MagicDamageFrost="MagicDamageFrost",t.MagicDamageShock="MagicDamageShock",t.MagicDamageFire="MagicDamageFire",t.MagicRune="MagicRune"}(m||(m={})),function(t){t.Frost="Frost Damage",t.Fire="Fire Damage",t.Shock="Shock Damage"}(W||(W={})),function(t){t.Frost="Frost",t.Fire="Fire",t.Shock="Shock"}(D||(D={})),function(t){t[t.Novice=0]="Novice",t[t.Apprentice=25]="Apprentice",t[t.Adept=50]="Adept",t[t.Expert=75]="Expert",t[t.Master=100]="Master"}(S||(S={}));var E=t.settings["weapon-type-hit"].isPlayerReactionEnabled;(0,t.on)("hit",(function(r){if(r.aggressor&&r.target){var a=t.Game.getPlayer(),i=function(t){return x(t.target.getFormID())}(r),o=(r.target.getFormID().toString(),function(t){return x(t.aggressor.getFormID())}(r));if(t.WornObject,!(i&&i.getAnimationVariableBool("IsBlocking")||i&&i.getAnimationVariableBool("bIdlePlaying")||o===a&&i.isPlayerTeammate()||i===t.Game.getPlayer()&&!1===E||i&&i.isInKillMove()||o&&o.isInKillMove()||41!==r.source.getType())){var c=o.getEquippedWeapon(!1),n=o.getEquippedWeapon(!0),h=o.getEquippedSpell(0),f=o.getEquippedSpell(1),s=c?c.getWeaponType():e.Fist,g=n?n.getWeaponType():e.Fist;u=s!==g||h||f?r.isPowerAttack?y.powAtk:y.regAtk:r.isPowerAttack?d.powAtk:d.regAtk;var p=function(t,r,a,i){return 0===t.source.getName().length?"Fist":r&&t.source.getName()===r.getName()?e[a]:e[i]}(r,c,s,g);!function(e,r,a,i,o){!function(e){var r;return e.target.getFormID()!==(null===(r=t.Game.getPlayer())||void 0===r?void 0:r.getFormID())}(e)?N(r,a.player[i]+o):N(r,a.npc[i]+o)}(r,i,u,p,"")}}})),(0,t.on)("consoleMessage",(function(e){var r=e.message.replace(g,(function(t){return s[t]}));t.browser.executeJavaScript('console.table("'+r+'")')}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SWQsRUFBTVksT0FBT2UsWUFBY2IsRUFBWWEsVUFDaENyRSxFQUFZbUUsR0FHcEJuRSxFQUFZb0UsR0RnT1ZHLENBQVU3QixFQUFPYyxFQUFhTSxFQUFpQkcsSUN0UHpELFNBQXNCdkIsRUFBT0csRUFBYXZCLEVBQUtrRCxFQUFRQyxJQWR2RCxTQUFlL0IsR0FDbEIsSUFBSWdDLEVBQ0osT0FBT2hDLEVBQU1FLE9BQU9FLGVBQTZDLFFBQTNCNEIsRUFBSyxFQUFBeEMsS0FBQSxtQkFBcUMsSUFBUHdDLE9BQWdCLEVBQVNBLEVBQUc1QixhQWNyRzZCLENBQU1qQyxHQUVBTixFQUFVUyxFQUFhdkIsRUFBSU0sT0FBTzRDLEdBQVVDLEdBRDVDckMsRUFBVVMsRUFBYXZCLEVBQUlHLElBQUkrQyxHQUFVQyxHRG9QL0NHLENBQWFsQyxFQUFPRyxFQUFhdkIsRUFBS2dDLEVBak9wQixVQW1PdEIsSUFBQWIsSUFBRyxrQkFBa0IsU0FBVW9DLEdBQzNCLElBQUlDLEVBQU1ELEVBQUVFLFFBQVFDLFFBQVF0RSxHQUFhLFNBQVV1RSxHQUFTLE9BQU94RSxFQUFZd0UsTUFDL0UsRUFBQUMsUUFBQSxrQkFBMEIsa0JBQW9CSixFQUFNLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWFwb24tdHlwZS1oaXQvZXh0ZXJuYWwgdmFyIFtcInNreXJpbVBsYXRmb3JtXCJdIiwid2VicGFjazovL3dlYXBvbi10eXBlLWhpdC8uL3NyYy93ZWFwb24tdHlwZS1oaXQubW9kZWwudHMiLCJ3ZWJwYWNrOi8vd2VhcG9uLXR5cGUtaGl0Ly4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3dlYXBvbi10eXBlLWhpdC8uL3NyYy93ZWFwb24tdHlwZS1oaXQuaGVscGVycy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gc2t5cmltUGxhdGZvcm07IiwiZXhwb3J0IHZhciBodG1sRXNjYXBlcyA9IHtcclxuICAgICdcIic6ICdcXFxcXCInLFxyXG4gICAgXCInXCI6IFwiXFxcXCdcIixcclxuICAgIFwiXFxcXFwiOiBcIlxcXFxcXFxcXCIsXHJcbiAgICBcIjxcIjogXCJcXFxcPFwiLFxyXG4gICAgXCI+XCI6IFwiXFxcXD5cIixcclxufTtcclxuZXhwb3J0IHZhciBodG1sRXNjYXBlciA9IC9bJjw+XCInXFxcXFxcL10vO1xyXG5leHBvcnQgdmFyIFdlYXBvblR5cGVzO1xyXG4oZnVuY3Rpb24gKFdlYXBvblR5cGVzKSB7XHJcbiAgICBXZWFwb25UeXBlc1tXZWFwb25UeXBlc1tcIkZpc3RcIl0gPSAwXSA9IFwiRmlzdFwiO1xyXG4gICAgV2VhcG9uVHlwZXNbV2VhcG9uVHlwZXNbXCJTd29yZFwiXSA9IDFdID0gXCJTd29yZFwiO1xyXG4gICAgV2VhcG9uVHlwZXNbV2VhcG9uVHlwZXNbXCJEYWdnZXJcIl0gPSAyXSA9IFwiRGFnZ2VyXCI7XHJcbiAgICBXZWFwb25UeXBlc1tXZWFwb25UeXBlc1tcIldhckF4ZVwiXSA9IDNdID0gXCJXYXJBeGVcIjtcclxuICAgIFdlYXBvblR5cGVzW1dlYXBvblR5cGVzW1wiTWFjZVwiXSA9IDRdID0gXCJNYWNlXCI7XHJcbiAgICBXZWFwb25UeXBlc1tXZWFwb25UeXBlc1tcIkdyZWF0c3dvcmRcIl0gPSA1XSA9IFwiR3JlYXRzd29yZFwiO1xyXG4gICAgV2VhcG9uVHlwZXNbV2VhcG9uVHlwZXNbXCJCYXR0bGVheGVcIl0gPSA2XSA9IFwiQmF0dGxlYXhlXCI7XHJcbiAgICBXZWFwb25UeXBlc1tXZWFwb25UeXBlc1tcIldhcmhhbW1lclwiXSA9IDZdID0gXCJXYXJoYW1tZXJcIjtcclxuICAgIFdlYXBvblR5cGVzW1dlYXBvblR5cGVzW1wiQm93XCJdID0gN10gPSBcIkJvd1wiO1xyXG4gICAgV2VhcG9uVHlwZXNbV2VhcG9uVHlwZXNbXCJTdGFmZlwiXSA9IDhdID0gXCJTdGFmZlwiO1xyXG4gICAgV2VhcG9uVHlwZXNbV2VhcG9uVHlwZXNbXCJDcm9zc2Jvd1wiXSA9IDldID0gXCJDcm9zc2Jvd1wiO1xyXG59KShXZWFwb25UeXBlcyB8fCAoV2VhcG9uVHlwZXMgPSB7fSkpO1xyXG5leHBvcnQgdmFyIFdlYXBvblR5cGVFdmVudFBsYXllcjtcclxuKGZ1bmN0aW9uIChXZWFwb25UeXBlRXZlbnRQbGF5ZXIpIHtcclxuICAgIFdlYXBvblR5cGVFdmVudFBsYXllcltcIkZpc3RcIl0gPSBcImhpdEZpc3RQbGF5ZXJcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudFBsYXllcltcIlN3b3JkXCJdID0gXCJoaXRTd29yZFBsYXllclwiO1xyXG4gICAgV2VhcG9uVHlwZUV2ZW50UGxheWVyW1wiRGFnZ2VyXCJdID0gXCJoaXREYWdnZXJQbGF5ZXJcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudFBsYXllcltcIldhckF4ZVwiXSA9IFwiaGl0V2FyQXhlUGxheWVyXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnRQbGF5ZXJbXCJNYWNlXCJdID0gXCJoaXRNYWNlUGxheWVyXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnRQbGF5ZXJbXCJHcmVhdHN3b3JkXCJdID0gXCJoaXRHcmVhdHN3b3JkUGxheWVyXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnRQbGF5ZXJbXCJCYXR0bGVheGVcIl0gPSBcImhpdEJhdHRsZUF4ZVdhcmhhbW1lclBsYXllclwiO1xyXG4gICAgV2VhcG9uVHlwZUV2ZW50UGxheWVyW1wiV2FyaGFtbWVyXCJdID0gXCJoaXRCYXR0bGVBeGVXYXJoYW1tZXJQbGF5ZXJcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudFBsYXllcltcIkJvd1wiXSA9IFwiaGl0Qm93UGxheWVyXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnRQbGF5ZXJbXCJTdGFmZlwiXSA9IFwiaGl0U3RhZmZQbGF5ZXJcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudFBsYXllcltcIkNyb3NzYm93XCJdID0gXCJoaXRDcm9zc2Jvd1BsYXllclwiO1xyXG59KShXZWFwb25UeXBlRXZlbnRQbGF5ZXIgfHwgKFdlYXBvblR5cGVFdmVudFBsYXllciA9IHt9KSk7XHJcbmV4cG9ydCB2YXIgV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnRQbGF5ZXI7XHJcbihmdW5jdGlvbiAoV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnRQbGF5ZXIpIHtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyW1wiRmlzdFwiXSA9IFwiaGl0UG93ZXJBdHRhY2tGaXN0UGxheWVyXCI7XHJcbiAgICBXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudFBsYXllcltcIlN3b3JkXCJdID0gXCJoaXRQb3dlckF0dGFja1N3b3JkUGxheWVyXCI7XHJcbiAgICBXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudFBsYXllcltcIkRhZ2dlclwiXSA9IFwiaGl0UG93ZXJBdHRhY2tEYWdnZXJQbGF5ZXJcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyW1wiV2FyQXhlXCJdID0gXCJoaXRQb3dlckF0dGFja1dhckF4ZVBsYXllclwiO1xyXG4gICAgV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnRQbGF5ZXJbXCJNYWNlXCJdID0gXCJoaXRQb3dlckF0dGFja01hY2VQbGF5ZXJcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyW1wiR3JlYXRzd29yZFwiXSA9IFwiaGl0UG93ZXJBdHRhY2tHcmVhdHN3b3JkUGxheWVyXCI7XHJcbiAgICBXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudFBsYXllcltcIkJhdHRsZWF4ZVwiXSA9IFwiaGl0UG93ZXJBdHRhY2tCYXR0bGVBeGVXYXJoYW1tZXJQbGF5ZXJcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyW1wiV2FyaGFtbWVyXCJdID0gXCJoaXRQb3dlckF0dGFja0JhdHRsZUF4ZVdhcmhhbW1lclBsYXllclwiO1xyXG4gICAgV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnRQbGF5ZXJbXCJTdGFmZlwiXSA9IFwiaGl0UG93ZXJBdHRhY2tTdGFmZlBsYXllclwiO1xyXG59KShXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudFBsYXllciB8fCAoV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnRQbGF5ZXIgPSB7fSkpO1xyXG5leHBvcnQgdmFyIFdlYXBvblR5cGVFdmVudE5wYztcclxuKGZ1bmN0aW9uIChXZWFwb25UeXBlRXZlbnROcGMpIHtcclxuICAgIFdlYXBvblR5cGVFdmVudE5wY1tcIkZpc3RcIl0gPSBcImhpdEZpc3ROcGNcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudE5wY1tcIlN3b3JkXCJdID0gXCJoaXRTd29yZE5wY1wiO1xyXG4gICAgV2VhcG9uVHlwZUV2ZW50TnBjW1wiRGFnZ2VyXCJdID0gXCJoaXREYWdnZXJOcGNcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudE5wY1tcIldhckF4ZVwiXSA9IFwiaGl0V2FyQXhlTnBjXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnROcGNbXCJNYWNlXCJdID0gXCJoaXRNYWNlTnBjXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnROcGNbXCJHcmVhdHN3b3JkXCJdID0gXCJoaXRHcmVhdHN3b3JkTnBjXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnROcGNbXCJCYXR0bGVheGVcIl0gPSBcImhpdEJhdHRsZUF4ZVdhcmhhbW1lck5wY1wiO1xyXG4gICAgV2VhcG9uVHlwZUV2ZW50TnBjW1wiV2FyaGFtbWVyXCJdID0gXCJoaXRCYXR0bGVBeGVXYXJoYW1tZXJOcGNcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudE5wY1tcIkJvd1wiXSA9IFwiaGl0Qm93TnBjXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnROcGNbXCJTdGFmZlwiXSA9IFwiaGl0U3RhZmZOcGNcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudE5wY1tcIkNyb3NzYm93XCJdID0gXCJoaXRDcm9zc2Jvd05wY1wiO1xyXG59KShXZWFwb25UeXBlRXZlbnROcGMgfHwgKFdlYXBvblR5cGVFdmVudE5wYyA9IHt9KSk7XHJcbmV4cG9ydCB2YXIgV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnROcGM7XHJcbihmdW5jdGlvbiAoV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnROcGMpIHtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjW1wiRmlzdFwiXSA9IFwiaGl0UG93ZXJBdHRhY2tGaXN0TnBjXCI7XHJcbiAgICBXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudE5wY1tcIlN3b3JkXCJdID0gXCJoaXRQb3dlckF0dGFja1N3b3JkTnBjXCI7XHJcbiAgICBXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudE5wY1tcIkRhZ2dlclwiXSA9IFwiaGl0UG93ZXJBdHRhY2tEYWdnZXJOcGNcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjW1wiV2FyQXhlXCJdID0gXCJoaXRQb3dlckF0dGFja1dhckF4ZU5wY1wiO1xyXG4gICAgV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnROcGNbXCJNYWNlXCJdID0gXCJoaXRQb3dlckF0dGFja01hY2VOcGNcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjW1wiR3JlYXRzd29yZFwiXSA9IFwiaGl0UG93ZXJBdHRhY2tHcmVhdHN3b3JkTnBjXCI7XHJcbiAgICBXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudE5wY1tcIkJhdHRsZWF4ZVwiXSA9IFwiaGl0UG93ZXJBdHRhY2tCYXR0bGVBeGVXYXJoYW1tZXJOcGNcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjW1wiV2FyaGFtbWVyXCJdID0gXCJoaXRQb3dlckF0dGFja0JhdHRsZUF4ZVdhcmhhbW1lck5wY1wiO1xyXG4gICAgV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnROcGNbXCJTdGFmZlwiXSA9IFwiaGl0UG93ZXJBdHRhY2tTdGFmZk5wY1wiO1xyXG59KShXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudE5wYyB8fCAoV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnROcGMgPSB7fSkpO1xyXG5leHBvcnQgdmFyIFdlYXBvblR5cGVFdmVudE5wY0RXO1xyXG4oZnVuY3Rpb24gKFdlYXBvblR5cGVFdmVudE5wY0RXKSB7XHJcbiAgICBXZWFwb25UeXBlRXZlbnROcGNEV1tcIkZpc3RcIl0gPSBcImhpdEZpc3ROcGNEV1wiO1xyXG4gICAgV2VhcG9uVHlwZUV2ZW50TnBjRFdbXCJTd29yZFwiXSA9IFwiaGl0U3dvcmROcGNEV1wiO1xyXG4gICAgV2VhcG9uVHlwZUV2ZW50TnBjRFdbXCJEYWdnZXJcIl0gPSBcImhpdERhZ2dlck5wY0RXXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnROcGNEV1tcIldhckF4ZVwiXSA9IFwiaGl0V2FyQXhlTnBjRFdcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudE5wY0RXW1wiTWFjZVwiXSA9IFwiaGl0TWFjZU5wY0RXXCI7XHJcbn0pKFdlYXBvblR5cGVFdmVudE5wY0RXIHx8IChXZWFwb25UeXBlRXZlbnROcGNEVyA9IHt9KSk7XHJcbmV4cG9ydCB2YXIgV2VhcG9uVHlwZUV2ZW50UGxheWVyRFc7XHJcbihmdW5jdGlvbiAoV2VhcG9uVHlwZUV2ZW50UGxheWVyRFcpIHtcclxuICAgIFdlYXBvblR5cGVFdmVudFBsYXllckRXW1wiRmlzdFwiXSA9IFwiaGl0RmlzdFBsYXllckRXXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnRQbGF5ZXJEV1tcIlN3b3JkXCJdID0gXCJoaXRTd29yZFBsYXllckRXXCI7XHJcbiAgICBXZWFwb25UeXBlRXZlbnRQbGF5ZXJEV1tcIkRhZ2dlclwiXSA9IFwiaGl0RGFnZ2VyUGxheWVyRFdcIjtcclxuICAgIFdlYXBvblR5cGVFdmVudFBsYXllckRXW1wiV2FyQXhlXCJdID0gXCJoaXRXYXJBeGVQbGF5ZXJEV1wiO1xyXG4gICAgV2VhcG9uVHlwZUV2ZW50UGxheWVyRFdbXCJNYWNlXCJdID0gXCJoaXRNYWNlUGxheWVyRFdcIjtcclxufSkoV2VhcG9uVHlwZUV2ZW50UGxheWVyRFcgfHwgKFdlYXBvblR5cGVFdmVudFBsYXllckRXID0ge30pKTtcclxuZXhwb3J0IHZhciBXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudFBsYXllckRXO1xyXG4oZnVuY3Rpb24gKFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyRFcpIHtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyRFdbXCJGaXN0XCJdID0gXCJoaXRQb3dlckF0dGFja0Zpc3RQbGF5ZXJEV1wiO1xyXG4gICAgV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnRQbGF5ZXJEV1tcIlN3b3JkXCJdID0gXCJoaXRQb3dlckF0dGFja1N3b3JkUGxheWVyRFdcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyRFdbXCJEYWdnZXJcIl0gPSBcImhpdFBvd2VyQXR0YWNrRGFnZ2VyUGxheWVyRFdcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyRFdbXCJXYXJBeGVcIl0gPSBcImhpdFBvd2VyQXR0YWNrV2FyQXhlUGxheWVyRFdcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyRFdbXCJNYWNlXCJdID0gXCJoaXRQb3dlckF0dGFja01hY2VQbGF5ZXJEV1wiO1xyXG59KShXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudFBsYXllckRXIHx8IChXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudFBsYXllckRXID0ge30pKTtcclxuZXhwb3J0IHZhciBXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudE5wY0RXO1xyXG4oZnVuY3Rpb24gKFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjRFcpIHtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjRFdbXCJGaXN0XCJdID0gXCJoaXRQb3dlckF0dGFja0Zpc3ROcGNEV1wiO1xyXG4gICAgV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnROcGNEV1tcIlN3b3JkXCJdID0gXCJoaXRQb3dlckF0dGFja1N3b3JkTnBjRFdcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjRFdbXCJEYWdnZXJcIl0gPSBcImhpdFBvd2VyQXR0YWNrRGFnZ2VyTnBjRFdcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjRFdbXCJXYXJBeGVcIl0gPSBcImhpdFBvd2VyQXR0YWNrV2FyQXhlTnBjRFdcIjtcclxuICAgIFdlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjRFdbXCJNYWNlXCJdID0gXCJoaXRQb3dlckF0dGFja01hY2VOcGNEV1wiO1xyXG59KShXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudE5wY0RXIHx8IChXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudE5wY0RXID0ge30pKTtcclxuZXhwb3J0IHZhciB3ZWFwb25UeXBlRXZlbnQgPSB7XHJcbiAgICBwb3dBdGs6IHtcclxuICAgICAgICBucGM6IE9iamVjdC5jcmVhdGUoV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnROcGMpLFxyXG4gICAgICAgIHBsYXllcjogT2JqZWN0LmNyZWF0ZShXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudFBsYXllciksXHJcbiAgICB9LFxyXG4gICAgcmVnQXRrOiB7XHJcbiAgICAgICAgbnBjOiBPYmplY3QuY3JlYXRlKFdlYXBvblR5cGVFdmVudE5wYyksXHJcbiAgICAgICAgcGxheWVyOiBPYmplY3QuY3JlYXRlKFdlYXBvblR5cGVFdmVudFBsYXllciksXHJcbiAgICB9LFxyXG59O1xyXG5leHBvcnQgdmFyIGR1YWxXaWVsZFR5cGVFdmVudCA9IHtcclxuICAgIHBvd0F0azoge1xyXG4gICAgICAgIG5wYzogT2JqZWN0LmNyZWF0ZShXZWFwb25UeXBlUG93ZXJBdHRhY2tFdmVudE5wY0RXKSxcclxuICAgICAgICBwbGF5ZXI6IE9iamVjdC5jcmVhdGUoV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnRQbGF5ZXJEVyksXHJcbiAgICB9LFxyXG4gICAgcmVnQXRrOiB7XHJcbiAgICAgICAgbnBjOiBPYmplY3QuY3JlYXRlKFdlYXBvblR5cGVFdmVudE5wY0RXKSxcclxuICAgICAgICBwbGF5ZXI6IE9iamVjdC5jcmVhdGUoV2VhcG9uVHlwZUV2ZW50UGxheWVyRFcpLFxyXG4gICAgfSxcclxufTtcclxuZXhwb3J0IHZhciBNYWdpY0VmZmVjdEV2ZW50Tm92aWNlO1xyXG4oZnVuY3Rpb24gKE1hZ2ljRWZmZWN0RXZlbnROb3ZpY2UpIHtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnROb3ZpY2VbXCJGaXJlXCJdID0gXCJoaXRGaXJlRWZmZWN0Tm92aWNlXCI7XHJcbiAgICBNYWdpY0VmZmVjdEV2ZW50Tm92aWNlW1wiRnJvc3RcIl0gPSBcImhpdEZyb3N0RWZmZWN0Tm92aWNlXCI7XHJcbiAgICBNYWdpY0VmZmVjdEV2ZW50Tm92aWNlW1wiU2hvY2tcIl0gPSBcImhpdFNob2NrRWZmZWN0Tm92aWNlXCI7XHJcbn0pKE1hZ2ljRWZmZWN0RXZlbnROb3ZpY2UgfHwgKE1hZ2ljRWZmZWN0RXZlbnROb3ZpY2UgPSB7fSkpO1xyXG5leHBvcnQgdmFyIE1hZ2ljRWZmZWN0RXZlbnRBcHByZW50aWNlO1xyXG4oZnVuY3Rpb24gKE1hZ2ljRWZmZWN0RXZlbnRBcHByZW50aWNlKSB7XHJcbiAgICBNYWdpY0VmZmVjdEV2ZW50QXBwcmVudGljZVtcIkZpcmVcIl0gPSBcImhpdEZpcmVFZmZlY3RBcHByZW50aWNlXCI7XHJcbiAgICBNYWdpY0VmZmVjdEV2ZW50QXBwcmVudGljZVtcIkZyb3N0XCJdID0gXCJoaXRGcm9zdEVmZmVjdEFwcHJlbnRpY2VcIjtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRBcHByZW50aWNlW1wiU2hvY2tcIl0gPSBcImhpdFNob2NrRWZmZWN0QXBwcmVudGljZVwiO1xyXG59KShNYWdpY0VmZmVjdEV2ZW50QXBwcmVudGljZSB8fCAoTWFnaWNFZmZlY3RFdmVudEFwcHJlbnRpY2UgPSB7fSkpO1xyXG5leHBvcnQgdmFyIE1hZ2ljRWZmZWN0RXZlbnRBZGVwdDtcclxuKGZ1bmN0aW9uIChNYWdpY0VmZmVjdEV2ZW50QWRlcHQpIHtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRBZGVwdFtcIkZpcmVcIl0gPSBcImhpdEZpcmVFZmZlY3RBZGVwdFwiO1xyXG4gICAgTWFnaWNFZmZlY3RFdmVudEFkZXB0W1wiRnJvc3RcIl0gPSBcImhpdEZyb3N0RWZmZWN0QWRlcHRcIjtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRBZGVwdFtcIlNob2NrXCJdID0gXCJoaXRTaG9ja0VmZmVjdEFkZXB0XCI7XHJcbn0pKE1hZ2ljRWZmZWN0RXZlbnRBZGVwdCB8fCAoTWFnaWNFZmZlY3RFdmVudEFkZXB0ID0ge30pKTtcclxuZXhwb3J0IHZhciBNYWdpY0VmZmVjdEV2ZW50RXhwZXJ0O1xyXG4oZnVuY3Rpb24gKE1hZ2ljRWZmZWN0RXZlbnRFeHBlcnQpIHtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRFeHBlcnRbXCJGaXJlXCJdID0gXCJoaXRGaXJlRWZmZWN0RXhwZXJ0XCI7XHJcbiAgICBNYWdpY0VmZmVjdEV2ZW50RXhwZXJ0W1wiRnJvc3RcIl0gPSBcImhpdEZyb3N0RWZmZWN0RXhwZXJ0XCI7XHJcbiAgICBNYWdpY0VmZmVjdEV2ZW50RXhwZXJ0W1wiU2hvY2tcIl0gPSBcImhpdFNob2NrRWZmZWN0RXhwZXJ0XCI7XHJcbn0pKE1hZ2ljRWZmZWN0RXZlbnRFeHBlcnQgfHwgKE1hZ2ljRWZmZWN0RXZlbnRFeHBlcnQgPSB7fSkpO1xyXG5leHBvcnQgdmFyIE1hZ2ljRWZmZWN0RXZlbnRNYXN0ZXI7XHJcbihmdW5jdGlvbiAoTWFnaWNFZmZlY3RFdmVudE1hc3Rlcikge1xyXG4gICAgTWFnaWNFZmZlY3RFdmVudE1hc3RlcltcIkZpcmVcIl0gPSBcImhpdEZpcmVFZmZlY3RNYXN0ZXJcIjtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRNYXN0ZXJbXCJGcm9zdFwiXSA9IFwiaGl0RnJvc3RFZmZlY3RNYXN0ZXJcIjtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRNYXN0ZXJbXCJTaG9ja1wiXSA9IFwiaGl0U2hvY2tFZmZlY3RNYXN0ZXJcIjtcclxufSkoTWFnaWNFZmZlY3RFdmVudE1hc3RlciB8fCAoTWFnaWNFZmZlY3RFdmVudE1hc3RlciA9IHt9KSk7XHJcbmV4cG9ydCB2YXIgTWFnaWNFZmZlY3RFdmVudENvbmNlbnRyYXRpb247XHJcbihmdW5jdGlvbiAoTWFnaWNFZmZlY3RFdmVudENvbmNlbnRyYXRpb24pIHtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uW1wiRmlyZVwiXSA9IFwiaGl0RmlyZUVmZmVjdENvbmNlbnRyYXRpb25cIjtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uW1wiRnJvc3RcIl0gPSBcImhpdEZyb3N0RWZmZWN0Q29uY2VudHJhdGlvblwiO1xyXG4gICAgTWFnaWNFZmZlY3RFdmVudENvbmNlbnRyYXRpb25bXCJTaG9ja1wiXSA9IFwiaGl0U2hvY2tFZmZlY3RDb25jZW50cmF0aW9uXCI7XHJcbn0pKE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uIHx8IChNYWdpY0VmZmVjdEV2ZW50Q29uY2VudHJhdGlvbiA9IHt9KSk7XHJcbmV4cG9ydCB2YXIgTWFnaWNFZmZlY3RFdmVudENvbmNlbnRyYXRpb25FbmQ7XHJcbihmdW5jdGlvbiAoTWFnaWNFZmZlY3RFdmVudENvbmNlbnRyYXRpb25FbmQpIHtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uRW5kW1wiRmlyZVwiXSA9IFwiaGl0RmlyZUVmZmVjdENvbmNlbnRyYXRpb25FbmRcIjtcclxuICAgIE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uRW5kW1wiRnJvc3RcIl0gPSBcImhpdEZyb3N0RWZmZWN0Q29uY2VudHJhdGlvbkVuZFwiO1xyXG4gICAgTWFnaWNFZmZlY3RFdmVudENvbmNlbnRyYXRpb25FbmRbXCJTaG9ja1wiXSA9IFwiaGl0U2hvY2tFZmZlY3RDb25jZW50cmF0aW9uRW5kXCI7XHJcbn0pKE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uRW5kIHx8IChNYWdpY0VmZmVjdEV2ZW50Q29uY2VudHJhdGlvbkVuZCA9IHt9KSk7XHJcbmV4cG9ydCB2YXIgTWFnaWNFZmZlY3RLZXlXb3JkO1xyXG4oZnVuY3Rpb24gKE1hZ2ljRWZmZWN0S2V5V29yZCkge1xyXG4gICAgTWFnaWNFZmZlY3RLZXlXb3JkW1wiTWFnaWNEYW1hZ2VGcm9zdFwiXSA9IFwiTWFnaWNEYW1hZ2VGcm9zdFwiO1xyXG4gICAgTWFnaWNFZmZlY3RLZXlXb3JkW1wiTWFnaWNEYW1hZ2VTaG9ja1wiXSA9IFwiTWFnaWNEYW1hZ2VTaG9ja1wiO1xyXG4gICAgTWFnaWNFZmZlY3RLZXlXb3JkW1wiTWFnaWNEYW1hZ2VGaXJlXCJdID0gXCJNYWdpY0RhbWFnZUZpcmVcIjtcclxuICAgIE1hZ2ljRWZmZWN0S2V5V29yZFtcIk1hZ2ljUnVuZVwiXSA9IFwiTWFnaWNSdW5lXCI7XHJcbn0pKE1hZ2ljRWZmZWN0S2V5V29yZCB8fCAoTWFnaWNFZmZlY3RLZXlXb3JkID0ge30pKTtcclxuZXhwb3J0IHZhciBFbmNoYW50bWVudEVmZmVjdHM7XHJcbihmdW5jdGlvbiAoRW5jaGFudG1lbnRFZmZlY3RzKSB7XHJcbiAgICBFbmNoYW50bWVudEVmZmVjdHNbXCJGcm9zdFwiXSA9IFwiRnJvc3QgRGFtYWdlXCI7XHJcbiAgICBFbmNoYW50bWVudEVmZmVjdHNbXCJGaXJlXCJdID0gXCJGaXJlIERhbWFnZVwiO1xyXG4gICAgRW5jaGFudG1lbnRFZmZlY3RzW1wiU2hvY2tcIl0gPSBcIlNob2NrIERhbWFnZVwiO1xyXG59KShFbmNoYW50bWVudEVmZmVjdHMgfHwgKEVuY2hhbnRtZW50RWZmZWN0cyA9IHt9KSk7XHJcbmV4cG9ydCB2YXIgRW5jaGFudG1lbnRFdmVudDtcclxuKGZ1bmN0aW9uIChFbmNoYW50bWVudEV2ZW50KSB7XHJcbiAgICBFbmNoYW50bWVudEV2ZW50W1wiRnJvc3RcIl0gPSBcIkZyb3N0XCI7XHJcbiAgICBFbmNoYW50bWVudEV2ZW50W1wiRmlyZVwiXSA9IFwiRmlyZVwiO1xyXG4gICAgRW5jaGFudG1lbnRFdmVudFtcIlNob2NrXCJdID0gXCJTaG9ja1wiO1xyXG59KShFbmNoYW50bWVudEV2ZW50IHx8IChFbmNoYW50bWVudEV2ZW50ID0ge30pKTtcclxuZXhwb3J0IHZhciBNYWdpY0VmZmVjdFNraWxsTGV2ZWw7XHJcbihmdW5jdGlvbiAoTWFnaWNFZmZlY3RTa2lsbExldmVsKSB7XHJcbiAgICBNYWdpY0VmZmVjdFNraWxsTGV2ZWxbTWFnaWNFZmZlY3RTa2lsbExldmVsW1wiTm92aWNlXCJdID0gMF0gPSBcIk5vdmljZVwiO1xyXG4gICAgTWFnaWNFZmZlY3RTa2lsbExldmVsW01hZ2ljRWZmZWN0U2tpbGxMZXZlbFtcIkFwcHJlbnRpY2VcIl0gPSAyNV0gPSBcIkFwcHJlbnRpY2VcIjtcclxuICAgIE1hZ2ljRWZmZWN0U2tpbGxMZXZlbFtNYWdpY0VmZmVjdFNraWxsTGV2ZWxbXCJBZGVwdFwiXSA9IDUwXSA9IFwiQWRlcHRcIjtcclxuICAgIE1hZ2ljRWZmZWN0U2tpbGxMZXZlbFtNYWdpY0VmZmVjdFNraWxsTGV2ZWxbXCJFeHBlcnRcIl0gPSA3NV0gPSBcIkV4cGVydFwiO1xyXG4gICAgTWFnaWNFZmZlY3RTa2lsbExldmVsW01hZ2ljRWZmZWN0U2tpbGxMZXZlbFtcIk1hc3RlclwiXSA9IDEwMF0gPSBcIk1hc3RlclwiO1xyXG59KShNYWdpY0VmZmVjdFNraWxsTGV2ZWwgfHwgKE1hZ2ljRWZmZWN0U2tpbGxMZXZlbCA9IHt9KSk7XHJcbiIsImltcG9ydCB7IG9uLCBicm93c2VyLCBzZXR0aW5ncywgR2FtZSwgfSBmcm9tIFwiQHNreXJpbS1wbGF0Zm9ybS9za3lyaW0tcGxhdGZvcm1cIjtcclxuaW1wb3J0IHsgZ2V0QWdncmVzc29yLCBnZXRTb3VyY2UsIGdldFRhcmdldCwgc2VuZEhpdEV2ZW50LCB9IGZyb20gXCIuL3dlYXBvbi10eXBlLWhpdC5oZWxwZXJzXCI7XHJcbmltcG9ydCB7IFdlYXBvblR5cGVzLCBkdWFsV2llbGRUeXBlRXZlbnQsIHdlYXBvblR5cGVFdmVudCwgaHRtbEVzY2FwZXIsIGh0bWxFc2NhcGVzLCB9IGZyb20gXCIuL3dlYXBvbi10eXBlLWhpdC5tb2RlbFwiO1xyXG5pbXBvcnQgKiBhcyBzcCBmcm9tIFwic2t5cmltUGxhdGZvcm1cIjtcclxudmFyIGhpdDtcclxudmFyIGNvdW50ZXIgPSAwO1xyXG52YXIgY3VycmVudFRhcmdldDtcclxudmFyIHRhcmdldHMgPSBbXTtcclxuZXhwb3J0IHZhciBQTEFZRVJfSVNFTkFCTEVEID0gc2V0dGluZ3NbXCJ3ZWFwb24tdHlwZS1oaXRcIl1bXCJpc1BsYXllclJlYWN0aW9uRW5hYmxlZFwiXTtcclxuLy8gb24oXCJ1cGRhdGVcIiwgKCkgPT4ge1xyXG4vLyAgIGNvdW50ZXIrKztcclxuLy8gICBpZiAoY291bnRlciA9PT0gMTApIHtcclxuLy8gICAgIGNvbnN0IGZ4ID0gR2FtZS5nZXRGb3JtRnJvbUZpbGUoMHg1MDA1OTAwLCBcIk1hZ2ljSW1wYWN0LmVzcFwiKTtcclxuLy8gICAgIC8vIHByaW50Q29uc29sZShmeD8uZ2V0TmFtZSgpKTtcclxuLy8gICAgIC8vIHByaW50Q29uc29sZShHYW1lLmdldFBsYXllcigpPy5nZXRBY3RvclZhbHVlKFwiQmxvY2tcIikpO1xyXG4vLyAgICAgaWYgKHRhcmdldHMubGVuZ3RoID4gMCkge1xyXG4vLyAgICAgICB0YXJnZXRzID0gdGFyZ2V0cy5maWx0ZXIoaXNBbGl2ZSk7XHJcbi8vICAgICAgIHRhcmdldHMgPSB0YXJnZXRzLm1hcCgodGFyZ2V0KSA9PiB7XHJcbi8vICAgICAgICAgLy8gcHJpbnRDb25zb2xlKHRhcmdldC5hY3RpdmVIaXQgKyBcIiBcIiArIHRhcmdldC5yZWNlaXZlZEhpdCk7XHJcbi8vICAgICAgICAgaWYgKCF0YXJnZXQuYWN0aXZlSGl0ICYmICF0YXJnZXQucmVjZWl2ZWRIaXQpIHtcclxuLy8gICAgICAgICAgIGNvbnN0IGVuZEV2ZW50QWN0b3IgPSBnZXRBY3RvckZyb21Gb3JtSWQoTnVtYmVyKHRhcmdldC5pZCkpO1xyXG4vLyAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KGVuZEV2ZW50QWN0b3IsIFwiaGl0RW5kQ29uY2VudHJhdGlvblwiKTtcclxuLy8gICAgICAgICAgIHRhcmdldC5yZWNlaXZlZEhpdCA9IHRydWU7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgICAgIHJldHVybiB0YXJnZXQgYXMgQ29tYmF0QWN0b3I7XHJcbi8vICAgICAgIH0pO1xyXG4vLyAgICAgfVxyXG4vLyAgICAgdGFyZ2V0cy5mb3JFYWNoKCh0YXJnZXQpID0+IHtcclxuLy8gICAgICAgdGFyZ2V0LmFjdGl2ZUhpdCA9IGZhbHNlO1xyXG4vLyAgICAgfSk7XHJcbi8vICAgICBjb3VudGVyID0gMDtcclxuLy8gICB9XHJcbi8vIH0pO1xyXG5vbihcImhpdFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIGlmICghZXZlbnQuYWdncmVzc29yKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmICghZXZlbnQudGFyZ2V0KVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIHZhciBwbGF5ZXIgPSBHYW1lLmdldFBsYXllcigpO1xyXG4gICAgdmFyIHRhcmdldEFjdG9yID0gZ2V0VGFyZ2V0KGV2ZW50KTtcclxuICAgIHZhciBjdXJyZW50VGFyZ2V0ID0gZXZlbnQudGFyZ2V0LmdldEZvcm1JRCgpLnRvU3RyaW5nKCk7XHJcbiAgICB2YXIgYWdncmVzc29yQWN0b3IgPSBnZXRBZ2dyZXNzb3IoZXZlbnQpO1xyXG4gICAgdmFyIFdvcm5PYmplY3QgPSBzcC5Xb3JuT2JqZWN0O1xyXG4gICAgdmFyIGVuY2hhbnRtZW50ID0gXCJcIjtcclxuICAgIGlmICh0YXJnZXRBY3RvciAmJiB0YXJnZXRBY3Rvci5nZXRBbmltYXRpb25WYXJpYWJsZUJvb2woXCJJc0Jsb2NraW5nXCIpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHRhcmdldEFjdG9yICYmIHRhcmdldEFjdG9yLmdldEFuaW1hdGlvblZhcmlhYmxlQm9vbChcImJJZGxlUGxheWluZ1wiKSlcclxuICAgICAgICByZXR1cm47XHJcbiAgICBpZiAoYWdncmVzc29yQWN0b3IgPT09IHBsYXllciAmJiB0YXJnZXRBY3Rvci5pc1BsYXllclRlYW1tYXRlKCkpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgaWYgKHRhcmdldEFjdG9yID09PSBHYW1lLmdldFBsYXllcigpICYmIFBMQVlFUl9JU0VOQUJMRUQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKCh0YXJnZXRBY3RvciAmJiB0YXJnZXRBY3Rvci5pc0luS2lsbE1vdmUoKSkgfHxcclxuICAgICAgICAoYWdncmVzc29yQWN0b3IgJiYgYWdncmVzc29yQWN0b3IuaXNJbktpbGxNb3ZlKCkpKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmIChldmVudC5zb3VyY2UuZ2V0VHlwZSgpICE9PSA0MSkge1xyXG4gICAgICAgIC8vIGNvbnN0IHNwZWxsID0gU3BlbGwuZnJvbShldmVudC5zb3VyY2UpO1xyXG4gICAgICAgIC8vIGlmIChzcGVsbCkge1xyXG4gICAgICAgIC8vICAgY29uc3QgZWZmZWN0c0xlbmd0aCA9IHNwZWxsLmdldE1hZ2ljRWZmZWN0cygpPy5sZW5ndGggYXMgbnVtYmVyO1xyXG4gICAgICAgIC8vICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlZmZlY3RzTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAvLyAgICAgY29uc3QgbWFnaWNFZmZlY3QgPSBzcGVsbD8uZ2V0TnRoRWZmZWN0TWFnaWNFZmZlY3QoaSkgYXMgTWFnaWNFZmZlY3Q7XHJcbiAgICAgICAgLy8gICAgIGNvbnN0IHNraWxsID0gbWFnaWNFZmZlY3QuZ2V0U2tpbGxMZXZlbCgpO1xyXG4gICAgICAgIC8vICAgICBjb25zdCBjYXN0aW5nVHlwZSA9IG1hZ2ljRWZmZWN0LmdldENhc3RpbmdUeXBlKCk7XHJcbiAgICAgICAgLy8gICAgIC8vIHByaW50Q29uc29sZShza2lsbCk7XHJcbiAgICAgICAgLy8gICAgIGlmIChtYWdpY0VmZmVjdCkge1xyXG4gICAgICAgIC8vICAgICAgIGNvbnN0IGtleXdvcmRzID0gbWFnaWNFZmZlY3QuZ2V0S2V5d29yZHMoKTtcclxuICAgICAgICAvLyAgICAgICBpZiAoa2V5d29yZHMpIHtcclxuICAgICAgICAvLyAgICAgICAgIGNvbnN0IGtleXdvcmQgPSAoa2V5d29yZHNbMF0gYXMgS2V5d29yZCkuZ2V0U3RyaW5nKCk7XHJcbiAgICAgICAgLy8gICAgICAgICBpZiAoa2V5d29yZCA9PT0gTWFnaWNFZmZlY3RLZXlXb3JkLk1hZ2ljUnVuZSkge1xyXG4gICAgICAgIC8vICAgICAgICAgICB0YXJnZXRBY3Rvci5wdXNoQWN0b3JBd2F5KHRhcmdldEFjdG9yLCA1KTtcclxuICAgICAgICAvLyAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgaWYgKGtleXdvcmQgPT09IE1hZ2ljRWZmZWN0S2V5V29yZC5NYWdpY0RhbWFnZUZpcmUpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKGNhc3RpbmdUeXBlID09PSAyKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uLkZpcmUpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRhcmdldHMgPSBpc0hpdEJ5Q29uYyh0YXJnZXRzLCB0YXJnZXRBY3RvciwgY3VycmVudFRhcmdldCk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgdGFyZ2V0QWN0b3IsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICBNYWdpY0VmZmVjdEV2ZW50Q29uY2VudHJhdGlvbi5GaXJlXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKHNraWxsID09PSBNYWdpY0VmZmVjdFNraWxsTGV2ZWwuTm92aWNlKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnROb3ZpY2UuRmlyZSk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgdGFyZ2V0QWN0b3IsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICBNYWdpY0VmZmVjdEV2ZW50Tm92aWNlLkZpcmVcclxuICAgICAgICAvLyAgICAgICAgICAgICApO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgICBpZiAoc2tpbGwgPT09IE1hZ2ljRWZmZWN0U2tpbGxMZXZlbC5BcHByZW50aWNlKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRBcHByZW50aWNlLkZpcmUpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudEFwcHJlbnRpY2UuRmlyZVxyXG4gICAgICAgIC8vICAgICAgICAgICAgICk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICAgIGlmIChza2lsbCA9PT0gTWFnaWNFZmZlY3RTa2lsbExldmVsLkFkZXB0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRFeHBlcnQuRmlyZSk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgdGFyZ2V0QWN0b3IsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICBNYWdpY0VmZmVjdEV2ZW50QWRlcHQuRmlyZVxyXG4gICAgICAgIC8vICAgICAgICAgICAgICk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICAgIGlmIChza2lsbCA9PT0gTWFnaWNFZmZlY3RTa2lsbExldmVsLkV4cGVydCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudEV4cGVydC5GaXJlXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKHNraWxsID09PSBNYWdpY0VmZmVjdFNraWxsTGV2ZWwuTWFzdGVyKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRNYXN0ZXIuRmlyZSk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgdGFyZ2V0QWN0b3IsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICBNYWdpY0VmZmVjdEV2ZW50TWFzdGVyLkZpcmVcclxuICAgICAgICAvLyAgICAgICAgICAgICApO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgaWYgKGtleXdvcmQgPT09IE1hZ2ljRWZmZWN0S2V5V29yZC5NYWdpY0RhbWFnZUZyb3N0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgIGlmIChjYXN0aW5nVHlwZSA9PT0gMikge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRhcmdldHMgPSBpc0hpdEJ5Q29uYyh0YXJnZXRzLCB0YXJnZXRBY3RvciwgY3VycmVudFRhcmdldCk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uLkZyb3N0KTtcclxuICAgICAgICAvLyAgICAgICAgICAgICBEZWJ1Zy5zZW5kQW5pbWF0aW9uRXZlbnQoXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICB0YXJnZXRBY3RvcixcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIE1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uLkZyb3N0XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKHNraWxsID09PSBNYWdpY0VmZmVjdFNraWxsTGV2ZWwuTm92aWNlKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnROb3ZpY2UuRnJvc3QpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudE5vdmljZS5Gcm9zdFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICAgIGlmIChza2lsbCA9PT0gTWFnaWNFZmZlY3RTa2lsbExldmVsLkFwcHJlbnRpY2UpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICBwcmludENvbnNvbGUoTWFnaWNFZmZlY3RFdmVudEFwcHJlbnRpY2UuRnJvc3QpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudEFwcHJlbnRpY2UuRnJvc3RcclxuICAgICAgICAvLyAgICAgICAgICAgICApO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgICBpZiAoc2tpbGwgPT09IE1hZ2ljRWZmZWN0U2tpbGxMZXZlbC5BZGVwdCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHByaW50Q29uc29sZShNYWdpY0VmZmVjdEV2ZW50QWRlcHQuRnJvc3QpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudEFkZXB0LkZyb3N0XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKHNraWxsID09PSBNYWdpY0VmZmVjdFNraWxsTGV2ZWwuRXhwZXJ0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRFeHBlcnQuRnJvc3QpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudEV4cGVydC5GaXJlXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKHNraWxsID09PSBNYWdpY0VmZmVjdFNraWxsTGV2ZWwuTWFzdGVyKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRNYXN0ZXIuRnJvc3QpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudE1hc3Rlci5Gcm9zdFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICBpZiAoa2V5d29yZCA9PT0gTWFnaWNFZmZlY3RLZXlXb3JkLk1hZ2ljRGFtYWdlU2hvY2spIHtcclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKGNhc3RpbmdUeXBlID09PSAyKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGFyZ2V0cyA9IGlzSGl0QnlDb25jKHRhcmdldHMsIHRhcmdldEFjdG9yLCBjdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICAvLyAgICAgICAgICAgICBwcmludENvbnNvbGUoTWFnaWNFZmZlY3RFdmVudENvbmNlbnRyYXRpb24uU2hvY2spO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudENvbmNlbnRyYXRpb24uU2hvY2tcclxuICAgICAgICAvLyAgICAgICAgICAgICApO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgICBpZiAoc2tpbGwgPT09IE1hZ2ljRWZmZWN0U2tpbGxMZXZlbC5Ob3ZpY2UpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICBwcmludENvbnNvbGUoTWFnaWNFZmZlY3RFdmVudE5vdmljZS5TaG9jayk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgdGFyZ2V0QWN0b3IsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICBNYWdpY0VmZmVjdEV2ZW50Tm92aWNlLlNob2NrXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKHNraWxsID09PSBNYWdpY0VmZmVjdFNraWxsTGV2ZWwuQXBwcmVudGljZSkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHByaW50Q29uc29sZShNYWdpY0VmZmVjdEV2ZW50QXBwcmVudGljZS5TaG9jayk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgdGFyZ2V0QWN0b3IsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICBNYWdpY0VmZmVjdEV2ZW50QXBwcmVudGljZS5TaG9ja1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICAgIGlmIChza2lsbCA9PT0gTWFnaWNFZmZlY3RTa2lsbExldmVsLkFkZXB0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRBZGVwdC5TaG9jayk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgdGFyZ2V0QWN0b3IsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICBNYWdpY0VmZmVjdEV2ZW50QWRlcHQuU2hvY2tcclxuICAgICAgICAvLyAgICAgICAgICAgICApO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgICBpZiAoc2tpbGwgPT09IE1hZ2ljRWZmZWN0U2tpbGxMZXZlbC5FeHBlcnQpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICBwcmludENvbnNvbGUoTWFnaWNFZmZlY3RFdmVudEV4cGVydC5TaG9jayk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRGVidWcuc2VuZEFuaW1hdGlvbkV2ZW50KFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgdGFyZ2V0QWN0b3IsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICBNYWdpY0VmZmVjdEV2ZW50RXhwZXJ0LlNob2NrXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgaWYgKHNraWxsID09PSBNYWdpY0VmZmVjdFNraWxsTGV2ZWwuTWFzdGVyKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcHJpbnRDb25zb2xlKE1hZ2ljRWZmZWN0RXZlbnRNYXN0ZXIuU2hvY2spO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChcclxuICAgICAgICAvLyAgICAgICAgICAgICAgIHRhcmdldEFjdG9yLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgTWFnaWNFZmZlY3RFdmVudE1hc3Rlci5TaG9ja1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgfVxyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gICB9XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHZhciBzb3VyY2VSaWdodCA9IGFnZ3Jlc3NvckFjdG9yLmdldEVxdWlwcGVkV2VhcG9uKGZhbHNlKTtcclxuICAgIC8vIGlmIChzb3VyY2VSaWdodCkge1xyXG4gICAgLy8gICBjb25zdCB3ZWFwb25FbmNoYW50bWVudCA9IHNvdXJjZVJpZ2h0LmdldEVuY2hhbnRtZW50KCk7XHJcbiAgICAvLyAgIGNvbnN0IG1hZ2ljRWZmZWN0ID0gd2VhcG9uRW5jaGFudG1lbnQ/LmdldE50aEVmZmVjdE1hZ2ljRWZmZWN0KDApO1xyXG4gICAgLy8gICBjb25zdCBiYXNlQ29zdCA9IChtYWdpY0VmZmVjdD8uZ2V0QmFzZUNvc3QoKSBhcyBudW1iZXIpICsgMTtcclxuICAgIC8vICAgY29uc3QgY2hhcmdlID0gV29ybk9iamVjdC5HZXRJdGVtQ2hhcmdlKEdhbWUuZ2V0UGxheWVyKCksIDEsIDApO1xyXG4gICAgLy8gICBpZiAoYmFzZUNvc3QgPCBjaGFyZ2UpIHtcclxuICAgIC8vICAgICBpZiAod2VhcG9uRW5jaGFudG1lbnQpIHtcclxuICAgIC8vICAgICAgIGNvbnN0IGVuY2hhbnRtZW50TmFtZSA9IHdlYXBvbkVuY2hhbnRtZW50Py5nZXROYW1lKCkgYXMgc3RyaW5nO1xyXG4gICAgLy8gICAgICAgaWYgKGVuY2hhbnRtZW50TmFtZSA9PT0gRW5jaGFudG1lbnRFZmZlY3RzLkZpcmUpXHJcbiAgICAvLyAgICAgICAgIGVuY2hhbnRtZW50ID0gRW5jaGFudG1lbnRFdmVudC5GaXJlO1xyXG4gICAgLy8gICAgICAgaWYgKGVuY2hhbnRtZW50TmFtZSA9PT0gRW5jaGFudG1lbnRFZmZlY3RzLkZyb3N0KVxyXG4gICAgLy8gICAgICAgICBlbmNoYW50bWVudCA9IEVuY2hhbnRtZW50RXZlbnQuRnJvc3Q7XHJcbiAgICAvLyAgICAgICBpZiAoZW5jaGFudG1lbnROYW1lID09PSBFbmNoYW50bWVudEVmZmVjdHMuU2hvY2spXHJcbiAgICAvLyAgICAgICAgIGVuY2hhbnRtZW50ID0gRW5jaGFudG1lbnRFdmVudC5TaG9jaztcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgIH1cclxuICAgIC8vIH1cclxuICAgIHZhciBzb3VyY2VMZWZ0ID0gYWdncmVzc29yQWN0b3IuZ2V0RXF1aXBwZWRXZWFwb24odHJ1ZSk7XHJcbiAgICB2YXIgc3BlbGxSaWdodCA9IGFnZ3Jlc3NvckFjdG9yLmdldEVxdWlwcGVkU3BlbGwoMCk7XHJcbiAgICB2YXIgc3BlbGxMZWZ0ID0gYWdncmVzc29yQWN0b3IuZ2V0RXF1aXBwZWRTcGVsbCgxKTtcclxuICAgIHZhciB3ZWFwb25UeXBlUmlnaHQgPSBzb3VyY2VSaWdodFxyXG4gICAgICAgID8gc291cmNlUmlnaHQuZ2V0V2VhcG9uVHlwZSgpXHJcbiAgICAgICAgOiBXZWFwb25UeXBlcy5GaXN0O1xyXG4gICAgdmFyIHdlYXBvblR5cGVMZWZ0ID0gc291cmNlTGVmdFxyXG4gICAgICAgID8gc291cmNlTGVmdC5nZXRXZWFwb25UeXBlKClcclxuICAgICAgICA6IFdlYXBvblR5cGVzLkZpc3Q7XHJcbiAgICBpZiAod2VhcG9uVHlwZVJpZ2h0ID09PSB3ZWFwb25UeXBlTGVmdCAmJiAhc3BlbGxSaWdodCAmJiAhc3BlbGxMZWZ0KSB7XHJcbiAgICAgICAgaGl0ID0gZXZlbnQuaXNQb3dlckF0dGFja1xyXG4gICAgICAgICAgICA/IGR1YWxXaWVsZFR5cGVFdmVudC5wb3dBdGtcclxuICAgICAgICAgICAgOiBkdWFsV2llbGRUeXBlRXZlbnQucmVnQXRrO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaGl0ID0gZXZlbnQuaXNQb3dlckF0dGFjayA/IHdlYXBvblR5cGVFdmVudC5wb3dBdGsgOiB3ZWFwb25UeXBlRXZlbnQucmVnQXRrO1xyXG4gICAgfVxyXG4gICAgdmFyIHNvdXJjZSA9IGdldFNvdXJjZShldmVudCwgc291cmNlUmlnaHQsIHdlYXBvblR5cGVSaWdodCwgd2VhcG9uVHlwZUxlZnQpO1xyXG4gICAgc2VuZEhpdEV2ZW50KGV2ZW50LCB0YXJnZXRBY3RvciwgaGl0LCBzb3VyY2UsIGVuY2hhbnRtZW50KTtcclxufSk7XHJcbm9uKFwiY29uc29sZU1lc3NhZ2VcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgIHZhciBtc2cgPSBlLm1lc3NhZ2UucmVwbGFjZShodG1sRXNjYXBlciwgZnVuY3Rpb24gKG1hdGNoKSB7IHJldHVybiBodG1sRXNjYXBlc1ttYXRjaF07IH0pO1xyXG4gICAgYnJvd3Nlci5leGVjdXRlSmF2YVNjcmlwdCgnY29uc29sZS50YWJsZShcIicgKyBtc2cgKyAnXCIpJyk7XHJcbn0pO1xyXG4iLCJpbXBvcnQgeyBBY3RvciwgR2FtZSwgRGVidWcsIE9iamVjdFJlZmVyZW5jZSwgfSBmcm9tIFwiQHNreXJpbS1wbGF0Zm9ybS9za3lyaW0tcGxhdGZvcm1cIjtcclxuaW1wb3J0IHsgV2VhcG9uVHlwZXMgfSBmcm9tIFwiLi93ZWFwb24tdHlwZS1oaXQubW9kZWxcIjtcclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFjdG9yRnJvbUZvcm1JZChmb3JtSWQpIHtcclxuICAgIHZhciBhY3RvckZvcm0gPSBHYW1lLmdldEZvcm1FeChmb3JtSWQpO1xyXG4gICAgdmFyIGFjdG9yID0gQWN0b3IuZnJvbShhY3RvckZvcm0pO1xyXG4gICAgcmV0dXJuIGFjdG9yO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBpc05wYyhldmVudCkge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgcmV0dXJuIGV2ZW50LnRhcmdldC5nZXRGb3JtSUQoKSAhPT0gKChfYSA9IEdhbWUuZ2V0UGxheWVyKCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRGb3JtSUQoKSk7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFnZ3Jlc3NvcihldmVudCkge1xyXG4gICAgdmFyIGFncmVzc29yRnJtSWQgPSBldmVudC5hZ2dyZXNzb3IuZ2V0Rm9ybUlEKCk7XHJcbiAgICB2YXIgYWdyZXNzb3JBY3RvciA9IGdldEFjdG9yRnJvbUZvcm1JZChhZ3Jlc3NvckZybUlkKTtcclxuICAgIHJldHVybiBhZ3Jlc3NvckFjdG9yO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRUYXJnZXQoZXZlbnQpIHtcclxuICAgIHZhciB0YXJnZXRGcm1JZCA9IGV2ZW50LnRhcmdldC5nZXRGb3JtSUQoKTtcclxuICAgIHZhciB0YXJnZXRBY3RvciA9IGdldEFjdG9yRnJvbUZvcm1JZCh0YXJnZXRGcm1JZCk7XHJcbiAgICByZXR1cm4gdGFyZ2V0QWN0b3I7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIHNlbmRIaXRFdmVudChldmVudCwgdGFyZ2V0QWN0b3IsIGhpdCwgd2VhcG9uLCBlbmNoYW50bWVudCkge1xyXG4gICAgLy8gcHJpbnRDb25zb2xlKFwic2VuZGluZ1wiKTtcclxuICAgIGlzTnBjKGV2ZW50KVxyXG4gICAgICAgID8gc2VuZEV2ZW50KHRhcmdldEFjdG9yLCBoaXQubnBjW3dlYXBvbl0gKyBlbmNoYW50bWVudClcclxuICAgICAgICA6IHNlbmRFdmVudCh0YXJnZXRBY3RvciwgaGl0LnBsYXllclt3ZWFwb25dICsgZW5jaGFudG1lbnQpO1xyXG4gICAgcmV0dXJuO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBzZW5kRXZlbnQoYWN0b3IsIGhpdCkge1xyXG4gICAgLy8gYWN0b3IucHVzaEFjdG9yQXdheShhY3RvciwgNSk7XHJcbiAgICAvLyBwcmludENvbnNvbGUoaGl0KTtcclxuICAgIERlYnVnLnNlbmRBbmltYXRpb25FdmVudChhY3RvciwgaGl0KTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U291cmNlKGV2ZW50LCBzb3VyY2VSaWdodCwgcmlnaHQsIGxlZnQpIHtcclxuICAgIGlmIChldmVudC5zb3VyY2UuZ2V0TmFtZSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBcIkZpc3RcIjtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGlmIChzb3VyY2VSaWdodCkge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlLmdldE5hbWUoKSA9PT0gc291cmNlUmlnaHQuZ2V0TmFtZSgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gV2VhcG9uVHlwZXNbcmlnaHRdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBXZWFwb25UeXBlc1tsZWZ0XTtcclxuICAgIH1cclxufVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0T2JqUmVmRnJvbUlkKGZvcm1JZCkge1xyXG4gICAgdmFyIG9iakZvcm0gPSBHYW1lLmdldEZvcm1FeChmb3JtSWQpO1xyXG4gICAgcmV0dXJuIE9iamVjdFJlZmVyZW5jZS5mcm9tKG9iakZvcm0pO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBpc0FsaXZlKGNvbWJhdEFjdG9yKSB7XHJcbiAgICB2YXIgYWN0b3IgPSBnZXRBY3RvckZyb21Gb3JtSWQoTnVtYmVyKGNvbWJhdEFjdG9yLmlkKSk7XHJcbiAgICByZXR1cm4gIShhY3RvciA9PT0gbnVsbCB8fCBhY3RvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWN0b3IuaXNEZWFkKCkpO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBpc0hpdEJ5Q29uYyh0YXJnZXRzLCB0YXJnZXRBY3RvciwgY3VycmVudFRhcmdldCkge1xyXG4gICAgdmFyIHByZXNlbnQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7IHJldHVybiB0YXJnZXQuaWQgPT09IGN1cnJlbnRUYXJnZXQ7IH07XHJcbiAgICB2YXIgY3VycmVudCA9IHRhcmdldHMuc29tZShwcmVzZW50KTtcclxuICAgIGlmICh0YXJnZXRBY3RvciAmJiBpc0FsaXZlKHsgaWQ6IGN1cnJlbnRUYXJnZXQudG9TdHJpbmcoKSB9KSkge1xyXG4gICAgICAgIHRhcmdldHMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuaWQgPT09IGN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldC5yZWNlaXZlZEhpdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LmFjdGl2ZUhpdCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoIWN1cnJlbnQpIHtcclxuICAgICAgICAgICAgdGFyZ2V0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjdXJyZW50VGFyZ2V0LFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlSGl0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgcmVjZWl2ZWRIaXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGFyZ2V0cztcclxufVxyXG4iXSwibmFtZXMiOlsic2t5cmltUGxhdGZvcm0iLCJXZWFwb25UeXBlcyIsIldlYXBvblR5cGVFdmVudFBsYXllciIsIldlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50UGxheWVyIiwiV2VhcG9uVHlwZUV2ZW50TnBjIiwiV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnROcGMiLCJXZWFwb25UeXBlRXZlbnROcGNEVyIsIldlYXBvblR5cGVFdmVudFBsYXllckRXIiwiV2VhcG9uVHlwZVBvd2VyQXR0YWNrRXZlbnRQbGF5ZXJEVyIsIldlYXBvblR5cGVQb3dlckF0dGFja0V2ZW50TnBjRFciLCJodG1sRXNjYXBlcyIsImh0bWxFc2NhcGVyIiwiTWFnaWNFZmZlY3RFdmVudE5vdmljZSIsIk1hZ2ljRWZmZWN0RXZlbnRBcHByZW50aWNlIiwiTWFnaWNFZmZlY3RFdmVudEFkZXB0IiwiTWFnaWNFZmZlY3RFdmVudEV4cGVydCIsIk1hZ2ljRWZmZWN0RXZlbnRNYXN0ZXIiLCJNYWdpY0VmZmVjdEV2ZW50Q29uY2VudHJhdGlvbiIsIk1hZ2ljRWZmZWN0RXZlbnRDb25jZW50cmF0aW9uRW5kIiwiTWFnaWNFZmZlY3RLZXlXb3JkIiwiRW5jaGFudG1lbnRFZmZlY3RzIiwiRW5jaGFudG1lbnRFdmVudCIsIk1hZ2ljRWZmZWN0U2tpbGxMZXZlbCIsImhpdCIsIndlYXBvblR5cGVFdmVudCIsInBvd0F0ayIsIm5wYyIsIk9iamVjdCIsImNyZWF0ZSIsInBsYXllciIsInJlZ0F0ayIsImR1YWxXaWVsZFR5cGVFdmVudCIsImdldEFjdG9yRnJvbUZvcm1JZCIsImZvcm1JZCIsImFjdG9yRm9ybSIsIkdhbWUiLCJBY3RvciIsInNlbmRFdmVudCIsImFjdG9yIiwiRGVidWciLCJQTEFZRVJfSVNFTkFCTEVEIiwic2V0dGluZ3MiLCJvbiIsImV2ZW50IiwiYWdncmVzc29yIiwidGFyZ2V0IiwidGFyZ2V0QWN0b3IiLCJnZXRGb3JtSUQiLCJnZXRUYXJnZXQiLCJhZ2dyZXNzb3JBY3RvciIsInRvU3RyaW5nIiwiZ2V0QWdncmVzc29yIiwiZ2V0QW5pbWF0aW9uVmFyaWFibGVCb29sIiwiaXNQbGF5ZXJUZWFtbWF0ZSIsImlzSW5LaWxsTW92ZSIsInNvdXJjZSIsImdldFR5cGUiLCJzb3VyY2VSaWdodCIsImdldEVxdWlwcGVkV2VhcG9uIiwic291cmNlTGVmdCIsInNwZWxsUmlnaHQiLCJnZXRFcXVpcHBlZFNwZWxsIiwic3BlbGxMZWZ0Iiwid2VhcG9uVHlwZVJpZ2h0IiwiZ2V0V2VhcG9uVHlwZSIsIkZpc3QiLCJ3ZWFwb25UeXBlTGVmdCIsImlzUG93ZXJBdHRhY2siLCJyaWdodCIsImxlZnQiLCJnZXROYW1lIiwibGVuZ3RoIiwiZ2V0U291cmNlIiwid2VhcG9uIiwiZW5jaGFudG1lbnQiLCJfYSIsImlzTnBjIiwic2VuZEhpdEV2ZW50IiwiZSIsIm1zZyIsIm1lc3NhZ2UiLCJyZXBsYWNlIiwibWF0Y2giLCJicm93c2VyIl0sInNvdXJjZVJvb3QiOiIifQ==